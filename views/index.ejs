<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Chat ðŸ””</title>
        <link rel="stylesheet" href="../styles.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    </head>
    <!-- EstilizaÃ§Ã£o do chat -->
    <style>
        #layout{
            background-color: #696969;
            padding: 30px;
            max-height: 750px;
            max-width: 650px;
            border: 1px solid yellow;
        }

        h2 {
            color: yellow;
            font-size: 25px; 
            font-family: Arial, Helvetica, sans-serif;
        }
        
        #chat{
            border: 1px solid black;
            max-height: 350px;
            min-height: 350px;
            max-width: 100%;
            background-color: #696969;
            overflow-y: scroll;
            color: yellow;
        }

        #tela{
            background-color: #696969;
            border: 3px solid black;
            padding: 10px 20px; 
        }

        #buttonEnviar {
            border: 2px solid yellow;
            padding: 10px 20px; 
            border-radius: 5px;
            cursor: pointer;
            color: yellow;
            background-color: black;
        }

        #buttonEnviar:hover {
            border: 3px solid white;
            background-color: green;
            color: white;
        }

        <!-- CustomizaÃ§Ã£o das letras do campo de msg-->
        #msg {
            color: black;
            font-family: Arial, Helvetica, sans-serif;
        }

        <!-- CustomizaÃ§Ã£o das letras do campo de username-->
        #username {
            color: black ;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 20px;
        }

        #fundoTela{
            width: 100%;
            min-height: 100%;
            background-size: cover;
            
        }
    
    </style>
    <body> 
        <div 
            id="fundoTela" 
            style="text-align: center;">
                <img src="https://i0.wp.com/multarte.com.br/wp-content/uploads/2019/01/fundo-3d-preta6.jpg?fit=1280%2C720&ssl=1" alt="Imagem" />
            <div id="layout"> 
                <div id="tela">
                    <h2>
                        Chat ChatO ðŸ””
                    </h2>
                    
                    <div id="chat"></div>
                    <br>
                    <input 
                        type="text" 
                        name="" 
                        id="msg" 
                        placeholder="Digite sua mensagem" 
                        class="form-control"><br>
                    
                    <input 
                        type= "text" 
                        name= "" 
                        id= "username" 
                        placeholder= "Seu nome de usuÃ¡rio" 
                        class= "form-control">

                    <div class="d-grid gap-2"><br>
                        <button 
                            id="buttonEnviar" 
                            onclick= "enviar()" 
                            class= "btn btn-primary" 
                            type= "button">
                            Enviar
                        </button><br>
                    </div>
                </div>
            </div> 
        </div>
    </body>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.1/socket.io.js"></script>

    <script>

        var socket = io("http://localhost:3000");

        //Tratando clientes desconectados
        socket.on("disconnect",() => {
            console.log("Desconectado");
        });

        socket.on("showmsg", (data) => {
            console.log(data);
            var chat = document.getElementById("chat");
            var p  = document.createElement("p");
            p.innerHTML =  data.username + ": " + data.msg;
            chat.append(p);

        });

        function enviar(){

            var msgField  = document.getElementById("msg");
            var usernameField = document.getElementById("username");
            var msg = msgField.value;
            var username = usernameField.value;

            socket.emit("msg",{msg: msg, username: username});
        }

    </script>
</html>